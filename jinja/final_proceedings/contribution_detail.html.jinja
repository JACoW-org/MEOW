{% import 'authors_template.html.jinja' as authors_template %}

{% macro render(contribution) -%}

<div id="{{ contribution.code|lower }}" class="contrib-ancor"></div>

{% if contribution.is_included_in_proceedings and contribution.metadata: %}

<div class="contrib-header">
    <div class="contrib-code">{{ contribution.code|e }}</div>
    <div class="contrib-title">{{ contribution.title|e }}</div>
    <div class="contrib-pages">{{ contribution.metadata.page_count }}</div>
</div>

{% elif contribution.duplicate_of %}

<div class="contrib-header">
    <div class="contrib-code">
        <a onclick="openUrl(`session/{{ contribution.duplicate_of.session_code|lower }}/index.html#{{ contribution.duplicate_of.code|lower }}`)" href="javascript:void(0);">
            <s>{{ contribution.code|e }}</s>
        </a>
    </div>
    <div class="contrib-title">{{ contribution.title|e }}</div>
</div>

{% else %}

<div class="contrib-header">
    <div class="contrib-code"><s>{{ contribution.code|e }}</s></div>
    <div class="contrib-title">{{ contribution.title|e }}</div>
</div>

{% endif %}

{% if contribution.description: %}
<div class="contrib-desc">
    {{ contribution.description|e }}
</div>
{% endif %}

{% if contribution.authors_groups: %}
<div class="contrib-authors">
    {{ authors_template.render(contribution.authors_groups) }}
</div>
{% endif %}

{% if contribution.has_slides: %}
<div class="contrib-slides">
    <b>Slides</b>
    <a onclick="openUrl(`pdf/{{ contribution.slides_name }}`)" href="javascript:void(0);">
        {{ contribution.code|upper }}
    </a>
</div>
{% endif %}

{% if contribution.is_included_in_proceedings: %}
<div class="contrib-paper">
    <b>Paper</b>
    <a onclick="openUrl(`pdf/{{ contribution.paper_name }}`)" href="javascript:void(0);">
        {{ contribution.code|upper }}
    </a>
</div>

{% if contribution.metadata: %}
<div class="contrib-doi">
    <b>DOI</b>
    <span>reference for this paper:</span>
    <a onclick="openUrl(`doi/{{ contribution.code|lower }}/index.html`)" href="javascript:void(0);">
        {{ contribution.doi_data.doi_url }}
    </a>
</div>

<div class="contrib-dates">
    <b>About</b>
    <span>
        {% if contribution.reception: %}
        Received: {{ contribution.reception.strftime('%d %B %Y') }} —
        {% endif %}

        {% if contribution.revisitation: %}
        Revised: {{ contribution.revisitation.strftime('%d %B %Y') }} —
        {% endif %}

        {% if contribution.acceptance: %}
        Accepted: {{ contribution.acceptance.strftime('%d %B %Y') }} —
        {% endif %}

        {% if contribution.issuance: %}
        Issue date: {{ contribution.issuance.strftime('%d %B %Y') }}
        {% endif %}
    </span>
</div>

{% endif %}

{% endif %}

{% if contribution.reference: %}

<div class="contrib-cite">
    <b>Cite</b>
    <span>reference for this paper using:</span>
    <a onclick="openUrl(`reference/{{ contribution.code|lower }}-bibtex/index.html`)" href="javascript:void(0);">BibTeX</a>,
    <a onclick="openUrl(`reference/{{ contribution.code|lower }}-latex/index.html`)" href="javascript:void(0);">LaTeX</a>,
    <a onclick="openUrl(`reference/{{ contribution.code|lower }}-word/index.html`)" href="javascript:void(0);">Text/Word</a>,
    <a onclick="openUrl(`reference/{{ contribution.code|lower }}-ris/index.html`)" href="javascript:void(0);">RIS</a>,
    <a onclick="openUrl(`reference/{{ contribution.code|lower }}-endnote/index.html`)" href="javascript:void(0);">EndNote</a>
</div>

{% endif %}

{%- endmacro %}